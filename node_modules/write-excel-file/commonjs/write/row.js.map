{"version":3,"file":"row.js","names":["generateRow","row","rowIndex","getStyle","getSharedString","customFont","dateFormat","usesSchema","rowNumber","rowHeight","rowCells","map","cell","columnIndex","undefined","align","alignVertical","fontFamily","fontSize","fontWeight","fontStyle","height","wrap","color","backgroundColor","borderColor","borderStyle","leftBorderColor","leftBorderStyle","rightBorderColor","rightBorderStyle","topBorderColor","topBorderStyle","bottomBorderColor","bottomBorderStyle","type","value","format","isEmpty","detectValueType","String","Date","Number","Error","cellStyleId","generateCell","join","Boolean"],"sources":["../../source/write/row.js"],"sourcesContent":["// Copy-pasted from:\r\n// https://github.com/davidramos-om/zipcelx-on-steroids/blob/master/src/formatters/rows/formatRow.js\r\n\r\nimport generateCell from './cell.js'\r\n\r\n// import Integer from '../types/Integer.js'\r\n\r\nexport default function generateRow(row, rowIndex, {\r\n\tgetStyle,\r\n\tgetSharedString,\r\n\tcustomFont,\r\n\tdateFormat,\r\n\tusesSchema\r\n}) {\r\n\t// To ensure the row number starts as in Excel.\r\n\tconst rowNumber = rowIndex + 1\r\n\tlet rowHeight\r\n\tconst rowCells = row\r\n\t\t.map((cell, columnIndex) => {\r\n\t\t\tif (cell === undefined || cell === null) {\r\n\t\t\t\treturn ''\r\n\t\t\t}\r\n\r\n\t\t\tconst {\r\n\t\t\t\talign,\r\n\t\t\t\talignVertical,\r\n\t\t\t\tfontFamily,\r\n\t\t\t\tfontSize,\r\n\t\t\t\tfontWeight,\r\n\t\t\t\tfontStyle,\r\n\t\t\t\theight,\r\n\t\t\t\twrap,\r\n\t\t\t\tcolor,\r\n\t\t\t\tbackgroundColor,\r\n\t\t\t\tborderColor,\r\n\t\t\t\tborderStyle,\r\n\t\t\t\tleftBorderColor,\r\n\t\t\t\tleftBorderStyle,\r\n\t\t\t\trightBorderColor,\r\n\t\t\t\trightBorderStyle,\r\n\t\t\t\ttopBorderColor,\r\n\t\t\t\ttopBorderStyle,\r\n\t\t\t\tbottomBorderColor,\r\n\t\t\t\tbottomBorderStyle\r\n\t\t\t} = cell\r\n\r\n\t\t\tlet {\r\n\t\t\t\ttype,\r\n\t\t\t\tvalue,\r\n\t\t\t\tformat\r\n\t\t\t} = cell\r\n\r\n\t\t\tif (isEmpty(value)) {\r\n\t\t\t\tvalue = null\r\n\t\t\t} else {\r\n\t\t\t\t// Get cell value type.\r\n\t\t\t\tif (type === undefined) {\r\n\t\t\t\t\tif (!usesSchema) {\r\n\t\t\t\t\t\ttype = detectValueType(value)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (type === undefined) {\r\n\t\t\t\t\t\t// The default cell value type is `String`.\r\n\t\t\t\t\t\ttype = String\r\n\t\t\t\t\t\tvalue = String(value)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Validate `format` property.\r\n\t\t\tif (format) {\r\n\t\t\t\tif (type !== Date &&  type !== Number) { // && type !== Integer) {\r\n\t\t\t\t\tthrow new Error('`format` can only be used on `Date` or `Number` cells') // or `Integer` cells')\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (type === Date) {\r\n\t\t\t\t\tformat = dateFormat\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tlet cellStyleId\r\n\t\t\tif (\r\n\t\t\t\tfontFamily ||\r\n\t\t\t\tfontSize ||\r\n\t\t\t\tfontWeight ||\r\n\t\t\t\tfontStyle ||\r\n\t\t\t\talign ||\r\n\t\t\t\talignVertical ||\r\n\t\t\t\tformat ||\r\n\t\t\t\twrap ||\r\n\t\t\t\tcolor ||\r\n\t\t\t\tbackgroundColor ||\r\n\t\t\t\tborderColor ||\r\n\t\t\t\tborderStyle ||\r\n\t\t\t\tleftBorderColor ||\r\n\t\t\t\tleftBorderStyle ||\r\n\t\t\t\trightBorderColor ||\r\n\t\t\t\trightBorderStyle ||\r\n\t\t\t\ttopBorderColor ||\r\n\t\t\t\ttopBorderStyle ||\r\n\t\t\t\tbottomBorderColor ||\r\n\t\t\t\tbottomBorderStyle ||\r\n\t\t\t\tcustomFont\r\n\t\t\t) {\r\n\t\t\t\tcellStyleId = getStyle(\r\n\t\t\t\t\tfontFamily,\r\n\t\t\t\t\tfontSize,\r\n\t\t\t\t\tfontWeight,\r\n\t\t\t\t\tfontStyle,\r\n\t\t\t\t\talign,\r\n\t\t\t\t\talignVertical,\r\n\t\t\t\t\tformat,\r\n\t\t\t\t\twrap,\r\n\t\t\t\t\tcolor,\r\n\t\t\t\t\tbackgroundColor,\r\n\t\t\t\t\tborderColor,\r\n\t\t\t\t\tborderStyle,\r\n\t\t\t\t\tleftBorderColor,\r\n\t\t\t\t\tleftBorderStyle,\r\n\t\t\t\t\trightBorderColor,\r\n\t\t\t\t\trightBorderStyle,\r\n\t\t\t\t\ttopBorderColor,\r\n\t\t\t\t\ttopBorderStyle,\r\n\t\t\t\t\tbottomBorderColor,\r\n\t\t\t\t\tbottomBorderStyle\r\n\t\t\t\t)\r\n\t\t\t}\r\n\r\n\t\t\tif (height) {\r\n\t\t\t\tif (rowHeight === undefined || rowHeight < height) {\r\n\t\t\t\t\trowHeight = height\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn generateCell(\r\n\t\t\t\trowNumber,\r\n\t\t\t\tcolumnIndex,\r\n\t\t\t\tvalue,\r\n\t\t\t\ttype,\r\n\t\t\t\tcellStyleId,\r\n\t\t\t\tgetSharedString\r\n\t\t\t)\r\n\t\t})\r\n\t\t.join('')\r\n\r\n\treturn `<row r=\"${rowNumber}\"` +\r\n\t\t(rowHeight ? ` ht=\"${rowHeight}\" customHeight=\"1\"` : '') +\r\n\t\t'>' +\r\n\t\trowCells +\r\n\t\t'</row>'\r\n}\r\n\r\nfunction isEmpty(value) {\r\n  return value === undefined || value === null || value === ''\r\n}\r\n\r\nfunction detectValueType(value) {\r\n  switch (typeof value) {\r\n    case 'string':\r\n      return String\r\n    case 'number':\r\n      return Number\r\n    case 'boolean':\r\n      return Boolean\r\n    default:\r\n      if (value instanceof Date) {\r\n        return Date\r\n      }\r\n  }\r\n}"],"mappings":";;;;;;;AAGA;;;;;;AAEA;AAEe,SAASA,WAAT,CAAqBC,GAArB,EAA0BC,QAA1B,QAMZ;EAAA,IALFC,QAKE,QALFA,QAKE;EAAA,IAJFC,eAIE,QAJFA,eAIE;EAAA,IAHFC,UAGE,QAHFA,UAGE;EAAA,IAFFC,UAEE,QAFFA,UAEE;EAAA,IADFC,UACE,QADFA,UACE;EACF;EACA,IAAMC,SAAS,GAAGN,QAAQ,GAAG,CAA7B;EACA,IAAIO,SAAJ;EACA,IAAMC,QAAQ,GAAGT,GAAG,CAClBU,GADe,CACX,UAACC,IAAD,EAAOC,WAAP,EAAuB;IAC3B,IAAID,IAAI,KAAKE,SAAT,IAAsBF,IAAI,KAAK,IAAnC,EAAyC;MACxC,OAAO,EAAP;IACA;;IAED,IACCG,KADD,GAqBIH,IArBJ,CACCG,KADD;IAAA,IAECC,aAFD,GAqBIJ,IArBJ,CAECI,aAFD;IAAA,IAGCC,UAHD,GAqBIL,IArBJ,CAGCK,UAHD;IAAA,IAICC,QAJD,GAqBIN,IArBJ,CAICM,QAJD;IAAA,IAKCC,UALD,GAqBIP,IArBJ,CAKCO,UALD;IAAA,IAMCC,SAND,GAqBIR,IArBJ,CAMCQ,SAND;IAAA,IAOCC,MAPD,GAqBIT,IArBJ,CAOCS,MAPD;IAAA,IAQCC,IARD,GAqBIV,IArBJ,CAQCU,IARD;IAAA,IASCC,KATD,GAqBIX,IArBJ,CASCW,KATD;IAAA,IAUCC,eAVD,GAqBIZ,IArBJ,CAUCY,eAVD;IAAA,IAWCC,WAXD,GAqBIb,IArBJ,CAWCa,WAXD;IAAA,IAYCC,WAZD,GAqBId,IArBJ,CAYCc,WAZD;IAAA,IAaCC,eAbD,GAqBIf,IArBJ,CAaCe,eAbD;IAAA,IAcCC,eAdD,GAqBIhB,IArBJ,CAcCgB,eAdD;IAAA,IAeCC,gBAfD,GAqBIjB,IArBJ,CAeCiB,gBAfD;IAAA,IAgBCC,gBAhBD,GAqBIlB,IArBJ,CAgBCkB,gBAhBD;IAAA,IAiBCC,cAjBD,GAqBInB,IArBJ,CAiBCmB,cAjBD;IAAA,IAkBCC,cAlBD,GAqBIpB,IArBJ,CAkBCoB,cAlBD;IAAA,IAmBCC,iBAnBD,GAqBIrB,IArBJ,CAmBCqB,iBAnBD;IAAA,IAoBCC,iBApBD,GAqBItB,IArBJ,CAoBCsB,iBApBD;IAuBA,IACCC,IADD,GAIIvB,IAJJ,CACCuB,IADD;IAAA,IAECC,KAFD,GAIIxB,IAJJ,CAECwB,KAFD;IAAA,IAGCC,MAHD,GAIIzB,IAJJ,CAGCyB,MAHD;;IAMA,IAAIC,OAAO,CAACF,KAAD,CAAX,EAAoB;MACnBA,KAAK,GAAG,IAAR;IACA,CAFD,MAEO;MACN;MACA,IAAID,IAAI,KAAKrB,SAAb,EAAwB;QACvB,IAAI,CAACP,UAAL,EAAiB;UAChB4B,IAAI,GAAGI,eAAe,CAACH,KAAD,CAAtB;QACA;;QACD,IAAID,IAAI,KAAKrB,SAAb,EAAwB;UACvB;UACAqB,IAAI,GAAGK,MAAP;UACAJ,KAAK,GAAGI,MAAM,CAACJ,KAAD,CAAd;QACA;MACD;IACD,CAhD0B,CAkD3B;;;IACA,IAAIC,MAAJ,EAAY;MACX,IAAIF,IAAI,KAAKM,IAAT,IAAkBN,IAAI,KAAKO,MAA/B,EAAuC;QAAE;QACxC,MAAM,IAAIC,KAAJ,CAAU,uDAAV,CAAN,CADsC,CACmC;MACzE;IACD,CAJD,MAIO;MACN,IAAIR,IAAI,KAAKM,IAAb,EAAmB;QAClBJ,MAAM,GAAG/B,UAAT;MACA;IACD;;IAED,IAAIsC,WAAJ;;IACA,IACC3B,UAAU,IACVC,QADA,IAEAC,UAFA,IAGAC,SAHA,IAIAL,KAJA,IAKAC,aALA,IAMAqB,MANA,IAOAf,IAPA,IAQAC,KARA,IASAC,eATA,IAUAC,WAVA,IAWAC,WAXA,IAYAC,eAZA,IAaAC,eAbA,IAcAC,gBAdA,IAeAC,gBAfA,IAgBAC,cAhBA,IAiBAC,cAjBA,IAkBAC,iBAlBA,IAmBAC,iBAnBA,IAoBA7B,UArBD,EAsBE;MACDuC,WAAW,GAAGzC,QAAQ,CACrBc,UADqB,EAErBC,QAFqB,EAGrBC,UAHqB,EAIrBC,SAJqB,EAKrBL,KALqB,EAMrBC,aANqB,EAOrBqB,MAPqB,EAQrBf,IARqB,EASrBC,KATqB,EAUrBC,eAVqB,EAWrBC,WAXqB,EAYrBC,WAZqB,EAarBC,eAbqB,EAcrBC,eAdqB,EAerBC,gBAfqB,EAgBrBC,gBAhBqB,EAiBrBC,cAjBqB,EAkBrBC,cAlBqB,EAmBrBC,iBAnBqB,EAoBrBC,iBApBqB,CAAtB;IAsBA;;IAED,IAAIb,MAAJ,EAAY;MACX,IAAIZ,SAAS,KAAKK,SAAd,IAA2BL,SAAS,GAAGY,MAA3C,EAAmD;QAClDZ,SAAS,GAAGY,MAAZ;MACA;IACD;;IAED,OAAO,IAAAwB,gBAAA,EACNrC,SADM,EAENK,WAFM,EAGNuB,KAHM,EAIND,IAJM,EAKNS,WALM,EAMNxC,eANM,CAAP;EAQA,CA5He,EA6Hf0C,IA7He,CA6HV,EA7HU,CAAjB;EA+HA,OAAO,mBAAWtC,SAAX,WACLC,SAAS,mBAAWA,SAAX,6BAA2C,EAD/C,IAEN,GAFM,GAGNC,QAHM,GAIN,QAJD;AAKA;;AAED,SAAS4B,OAAT,CAAiBF,KAAjB,EAAwB;EACtB,OAAOA,KAAK,KAAKtB,SAAV,IAAuBsB,KAAK,KAAK,IAAjC,IAAyCA,KAAK,KAAK,EAA1D;AACD;;AAED,SAASG,eAAT,CAAyBH,KAAzB,EAAgC;EAC9B,gBAAeA,KAAf;IACE,KAAK,QAAL;MACE,OAAOI,MAAP;;IACF,KAAK,QAAL;MACE,OAAOE,MAAP;;IACF,KAAK,SAAL;MACE,OAAOK,OAAP;;IACF;MACE,IAAIX,KAAK,YAAYK,IAArB,EAA2B;QACzB,OAAOA,IAAP;MACD;;EAVL;AAYD"}